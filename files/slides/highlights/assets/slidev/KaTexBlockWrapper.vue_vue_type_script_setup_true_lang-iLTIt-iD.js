import{d as A,t as S,Q as k,O as E,z as v,D as b,o as I,b as x,f as q}from"../modules/vue-DGhvnXeY.js";import{r as C,aa as K,ab as N,C as B,ac as D,ad as M}from"../index-CyNyHnbf.js";import{u as P}from"./context-DyGfZKlu.js";function R(l,e){if(!e||e==="all"||e==="*")return C(1,l+1);if(e==="none")return[];const s=[];for(const t of e.split(/[,;]/g))if(!t.includes("-"))s.push(+t);else{const[r,a]=t.split("-",2);s.push(...C(+r,a?+a+1:l+1))}return K(s).filter(t=>t<=l).sort((t,r)=>t-r)}const V=A({__name:"KaTexBlockWrapper",props:{ranges:{type:Array,default:()=>[]},finally:{type:[String,Number],default:"last"},startLine:{type:Number,default:1},at:{type:[String,Number],default:"+1"}},setup(l){const e=l,{$clicksContext:s}=P(),t=S(),r=N();return k(()=>{s.unregister(r)}),E(()=>{var h;if(!s||!((h=e.ranges)!=null&&h.length))return;const a=s.calculateSince(e.at,e.ranges.length-1);s.register(r,a);const u=v(()=>a?Math.max(0,s.current-a.start+1):B),p=v(()=>e.finally==="last"?e.ranges.at(-1):e.finally.toString());b(()=>{if(!t.value)return;let f=e.ranges[u.value]??p.value;const d=f==="hide";t.value.classList.toggle(D,d),d&&(f=e.ranges[u.value+1]??p.value);const m=t.value.querySelectorAll(".mtable > [class*=col-align]");if(!m)return;const L=Array.from(m).map(i=>Array.from(i.querySelectorAll(":scope > .vlist-t > .vlist-r > .vlist > span > .mord"))),o=[];for(const i of L)i.forEach((c,n)=>{c&&(Array.isArray(o[n])?o[n].push(c):o[n]=[c])});const y=e.startLine,_=R(o.length+y-1,f);o.forEach((i,c)=>{const n=_.includes(c+y);i.forEach(g=>{g.classList.toggle(M,!0),g.classList.toggle("highlighted",n),g.classList.toggle("dishonored",!n)})})})}),(a,u)=>(I(),x("div",{ref_key:"el",ref:t,class:"slidev-katex-wrapper"},[q(a.$slots,"default")],512))}});export{V as _};
